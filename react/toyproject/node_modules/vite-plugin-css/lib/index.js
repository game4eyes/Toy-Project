"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function AntdVuePlugin(config) {
    let cache = new Map();
    return {
        enforce: 'post',
        name: `vite:css-import(${config.name})`,
        transform(code, id) {
            if (!/\.(vue|(jt)sx?$)/.test(id))
                return code;
            const reg = new RegExp(`import\\s+{(.*?)}\\s+from\\s+["']${config.name}["']`, 'g');
            let components = [];
            let r;
            while (r = reg.exec(code)) {
                const str = r[1];
                components.push(...str.split(','));
            }
            if (components.length) {
                const css = [];
                components.forEach(c => {
                    if (cache.has(c)) {
                        css.push(cache.get(c));
                        return;
                    }
                    const stylePath = config.tranfrom(c.split(' as ')[0].trim());
                    try {
                        require.resolve(`ant-design-vue/${stylePath}`);
                        cache.set(c, `ant-design-vue/${stylePath}`);
                        css.push(`ant-design-vue/${stylePath}`);
                    }
                    catch (error) {
                        console.warn(`Not found ${stylePath}`);
                    }
                });
                return css.map(name => `import '${name}';`).join('\n') + code;
            }
            return code;
        }
    };
}
exports.default = AntdVuePlugin;
//# sourceMappingURL=index.js.map